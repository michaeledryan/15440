package mikereduce.shared;

<<<<<<< HEAD
import AFS.Connection;
import mikereduce.worker.mapnode.MapNode;

=======
>>>>>>> 93107278bbd9975d35f6bbe01370dc0bb44b2663
import java.io.File;
import java.io.IOException;

/**
 * Takes output from a job and writes it to the correct file.
 */
public class OutputCommitter {

    // We assume the output location is unique for each job.
    private String outputPath;
    private Connection conn;

<<<<<<< HEAD
    public OutputCommitter(String path, Connection conn) {
        this.outputPath = path;
        this.conn = conn;
=======
    public OutputCommitter(File loc) {
        this.outputLocation = loc;
>>>>>>> 93107278bbd9975d35f6bbe01370dc0bb44b2663
    }

    public void commitLine(String line) {
        try {
            conn.writeFile(outputPath, line);
        } catch (IOException e) {
            e.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.
        }
    }

}
